---
// Layout.astro - Main layout component with integrated navbar
import NavBar from './navigation/NavBar.astro';
import Footer from './navigation/Footer.astro';
import CookieConsent from './navigation/CookieConsent.astro';
import theme from '../lib/therme';


export interface Props {
  title?: string;
  description?: string;
  image?: string;
  canonical?: string;
  noindex?: boolean;
  type?: 'website' | 'article';
}

const {
  title = 'Your Agency - Digital Solutions That Drive Results',
  description = 'We create exceptional digital experiences that help businesses grow and succeed in the modern world.',
  image = '/og-image.jpg',
  canonical,
  noindex = false,
  type = 'website'
} = Astro.props;

// Get current path for navbar active states
const currentPath = Astro.url.pathname;

// Navigation configuration
const navigation = {
  logo: { src: '/favicon.webp', alt: 'Your Agency' },
  links: [
    { href: '/', label: 'Home' },
    { href: '/services', label: 'Services' },
    { href: '/about', label: 'About' },
    { href: '/portfolio', label: 'Portfolio' },
    { href: '/blog', label: 'Blog' },
    { href: '/contact', label: 'Contact' }
  ],
  ctaButton: { 
    href: '/contact', 
    label: 'Get Started' 
  }
};

// Construct full URL for canonical and og:url
const site = Astro.site || 'https://youragency.com';
const canonicalURL = canonical || new URL(currentPath, site).href;
const ogImageURL = new URL(image, site).href;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/webp" href="/favicon.webp" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalURL} />
    
    <!-- Robots -->
    {noindex && <meta name="robots" content="noindex, nofollow" />}
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content={type} />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:site_name" content="Your Agency" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={ogImageURL} />
    
    <!-- Favicon variations -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    
    <!-- Preload critical fonts (add your font URLs) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    
    <!-- Theme color for mobile browsers -->
    <meta name="theme-color" content={theme.colors.primary[500]} />
    <meta name="msapplication-TileColor" content={theme.colors.primary[500]} />
  </head>
  
  <body>
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Navigation -->
    <NavBar 
      currentPath={currentPath}
      {...navigation}
    />
    
    <!-- Main content area -->
    <main id="main-content" class="main-content">
      <slot />
    </main>
    
    <!-- Footer (you can create a Footer component later) -->
   <Footer/>
   <CookieConsent 
  position="bottom-right"
  theme="light"
  title="Cookie Notice"
  description="Custom description..."
  acceptAllText="Accept All Cookies"
  policyUrl="/cookies"
  categories={{
    necessary: {
      title: "Essential Cookies",
      description: "Required for site functionality",
      required: true
    },
    analytics: {
      title: "Analytics",
      description: "Help us improve our website",
      required: false
    }
  }}
/>
  </body>
</html>

<style define:vars={{
  primaryColor: theme.colors.primary[500],
  neutralWhite: theme.colors.neutral[50],
  neutralGray: theme.colors.neutral[500],
  neutralDark: theme.colors.neutral[900],
  neutralLight: theme.colors.neutral[100],
  borderColor: theme.colors.border,
  fontSans: theme.typography.fontFamily.sans.join(', '),
  fontDisplay: theme.typography.fontFamily.display.join(', '),
  spacing4: theme.spacing[4],
  spacing6: theme.spacing[6],
  spacing8: theme.spacing[8],
  spacing12: theme.spacing[12],
  spacing16: theme.spacing[16],
  spacing20: theme.spacing[20],
  borderRadiusLg: theme.borderRadius.lg,
  shadowMd: theme.boxShadow.md,
  transitionNormal: theme.animation.duration.normal,
  navbarHeight: theme.components.navbar.height,
  mobileNavbarHeight: theme.components.navbar.mobileNavbarHeight
}}>
  /* CSS Reset and base styles */
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeSpeed;
    scroll-behavior: smooth;
  }

  body {
    margin: 0;
    padding: 0;
    min-height: 100vh;
    font-family: var(--fontSans);
    background: var(--neutralWhite);
    color: var(--neutralDark);
    line-height: 1.6;
    display: flex;
    flex-direction: column;
  }

  /* Skip link for accessibility */
  .skip-link {
    position: absolute;
    top: -40px;
    left: var(--spacing6);
    background: var(--primaryColor);
    color: var(--neutralWhite);
    padding: var(--spacing4) var(--spacing6);
    text-decoration: none;
    border-radius: var(--borderRadiusLg);
    font-weight: 600;
    z-index: 2000;
    transition: top var(--transitionNormal) ease;
  }

  .skip-link:focus {
    top: var(--spacing4);
  }

  /* Main content area */
  .main-content {
    flex: 1;
    padding-top: var(--mobileNavbarHeight); /* Account for sticky navbar */
  }

  @media (min-width: 768px) {
    .main-content {
      padding-top: var(--navbarHeight);
    }
  }

 

  /* Utility classes */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* Focus styles for better accessibility */
  :focus-visible {
    outline: 2px solid var(--primaryColor);
    outline-offset: 2px;
  }

  /* Smooth scrolling for reduced motion users */
  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
    
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .footer-links a {
      text-decoration: underline;
    }
  }

  /* Print styles */
  @media print {
    .skip-link,
    nav,
    .site-footer {
      display: none;
    }
    
    .main-content {
      padding-top: 0;
    }
  }
</style>